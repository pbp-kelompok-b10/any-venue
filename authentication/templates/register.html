{% extends "base.html" %}
{% load static %}

{% block content %}
<!-- ROOT CONTAINER -->
<div class="min-h-screen w-full relative bg-white overflow-hidden flex flex-col">

    <!-- BACKGROUND WRAPPER -->
    <div class="w-full flex-grow px-4 sm:px-8 md:px-16 pb-4 bg-gradient-to-b from-Light-Navy to-Flash-White flex flex-col justify-between items-center gap-16 sm:gap-24 md:gap-36 overflow-hidden">

        <!-- NAVBAR -->
        <div class="w-full max-w-[1280px] max-h-20 flex flex-col justify-center items-center overflow-hidden">
            <div class="w-full flex flex-wrap justify-between items-center gap-4 sm:gap-8 overflow-hidden px-4 sm:px-0">
                <div class="flex-1 flex justify-start items-start">
                    <a href="/" id="brand-link" class="text-2xl font-bold text-white tracking-wide transition-colors duration-300">
                        AnyVenue
                    </a>
                </div>
                <div class="flex flex-wrap justify-center items-center gap-1 sm:gap-[5px]">
                    <div class="text-center text-Flash-White text-base font-normal font-['Roboto'] leading-normal">Already have an account?</div>
                    <a href="{% url 'login' %}" class="text-center text-Flash-White text-base font-normal font-['Roboto'] underline leading-normal">Login Now</a>
                </div>
            </div>
        </div>

        <!-- MAIN SECTION -->
        <div class="w-full max-w-[1064px] flex flex-col justify-start items-center gap-6 sm:gap-12 px-4 sm:px-0 flex-grow">
            <div class="text-center text-Flash-White text-4xl sm:text-5xl font-bold font-['Roboto'] leading-tight sm:leading-[57.60px]">
                Join Us
            </div>

            <div class="w-full flex flex-col justify-center items-center gap-4 sm:gap-6">
                <div class="flex flex-col justify-center items-center text-center gap-2">
                    <div class="text-Flash-White text-xl sm:text-2xl font-bold font-['Roboto'] leading-loose">
                        Welcome to AnyVenue!
                    </div>
                    <div class="text-Flash-White text-sm sm:text-base font-normal font-['Roboto'] leading-normal">
                        Continue discovering and managing your experiences with Anyvenue.
                    </div>
                </div>
            </div>

            <!-- FORM REGISTER AJAX -->
            <form id="registerForm" class="w-full max-w-[580px] p-6 sm:p-8 bg-white/70 outline outline-1 outline-offset-[-1px] outline-Color-Scheme-1-Border flex flex-col justify-start items-start gap-4 sm:gap-6 rounded-lg">
                {% csrf_token %}
                <div class="w-full flex flex-col justify-start items-start gap-4 sm:gap-6">

                    <div class="w-full flex flex-col justify-start items-start gap-2">
                        <label class="text-Color-Scheme-1-Text text-base font-normal font-['Roboto'] leading-normal">Username</label>
                        <input type="text" id="username" name="username" class="w-full p-3 outline outline-1 outline-Color-Neutral-Darkest bg-transparent focus:bg-Flash-White rounded-md" required>
                    </div>

                    <div class="w-full flex flex-col justify-start items-start gap-2">
                        <label class="text-Color-Scheme-1-Text text-base font-normal font-['Roboto'] leading-normal">Password</label>
                        <input type="password" id="password1" name="password1" class="w-full p-3 outline outline-1 outline-Color-Neutral-Darkest bg-transparent focus:bg-Flash-White rounded-md" required>
                    </div>

                    <div class="w-full flex flex-col justify-start items-start gap-2">
                        <label class="text-Color-Scheme-1-Text text-base font-normal font-['Roboto'] leading-normal">Confirm Password</label>
                        <input type="password" id="password2" name="password2" class="w-full p-3 outline outline-1 outline-Color-Neutral-Darkest bg-transparent focus:bg-Flash-White rounded-md" required>
                    </div>

                    <div class="w-full flex flex-col justify-start items-start gap-2">
                        <label class="text-Color-Scheme-1-Text text-base font-normal font-['Roboto'] leading-normal">
                            Got a place you want to share with others?  Become an Owner and start adding your own venue!
                        </label>
                        <label class="flex items-center gap-2">
                            <input type="checkbox" id="is_owner" name="is_owner" class="w-4 h-4">
                            <span class="text-Color-Neutral-Darkest text-base font-normal font-['Roboto'] leading-normal">I am an Owner</span>
                        </label>
                    </div>

                </div>

                <div id="registerMessage" class="text-red-600 text-sm"></div>

                <div class="w-full pt-4 sm:pt-6 flex flex-wrap justify-end items-start gap-3 sm:gap-4">
                    <button type="button" class="px-4 sm:px-5 py-2 outline outline-1 outline-Color-Neutral-Darkest flex justify-center items-center gap-2 rounded-md">
                        <div class="text-Color-Neutral-Darkest text-base font-normal font-['Roboto'] leading-normal">Back</div>
                    </button>
                    <button type="submit" class="px-4 sm:px-5 py-2 bg-black outline outline-1 outline-Color-Neutral-Darkest flex justify-center items-center gap-2 rounded-md">
                        <div class="text-white text-base font-normal font-['Roboto'] leading-normal">Create Account</div>
                    </button>
                </div>
            </form>
        </div>

        <!-- FOOTER -->
        <div class="w-full max-w-[1280px] h-auto flex justify-center items-center py-4">
            <div class="text-center text-Color-Scheme-1-Text text-xs sm:text-sm font-normal font-['Roboto'] leading-tight">
                © 2025 AnyVenue
            </div>
        </div>
    </div>
</div>

<!-- SCRIPT -->
<script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
<script>
    $("#registerForm").submit(function(e){
        e.preventDefault();

        const data = {
            username: $("#username").val(),
            password1: $("#password1").val(),
            password2: $("#password2").val(),
            is_owner: $("#is_owner").is(":checked"),
            csrfmiddlewaretoken: $("input[name='csrfmiddlewaretoken']").val()
        };

        $.ajax({
            type: "POST",
            url: "{% url 'register' %}",  // ganti sesuai URL pattern kamu
            data: data,
            success: function (response) {
                if (response.success) {
                    alert(response.message);
                    window.location.href = "{% url 'login' %}";
                } else {
                    $("#registerMessage").text(response.error || "Failed to register.");
                }
            },
            error: function (xhr) {
                $("#registerMessage").text("Server error: " + xhr.status);
                console.log("Response:", xhr.responseText);
            }
        });
    });
</script>

{% endblock content %}
